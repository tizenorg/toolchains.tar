From da1818263165e235483ed8f72153ab6cf0671564 Mon Sep 17 00:00:00 2001
Message-Id: <da1818263165e235483ed8f72153ab6cf0671564.1302244899.git.yan.i.li@intel.com>
From: Yan Li <yan.i.li@intel.com>
Date: Fri, 8 Apr 2011 14:40:56 +0800
Subject: [PATCH] BMC#6647 - CVE-2010-0624 Heap-based buffer overflow in the rmt_read__ function


Signed-off-by: Yan Li <yan.i.li@intel.com>
---
 lib/rtapelib.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/lib/rtapelib.c b/lib/rtapelib.c
index af19b04..9546b62 100644
--- a/lib/rtapelib.c
+++ b/lib/rtapelib.c
@@ -573,6 +573,9 @@ rmt_read__ (int handle, char *buffer, size_t length)
       || (status = get_status (handle)) == SAFE_READ_ERROR)
     return SAFE_READ_ERROR;
 
+  if (status > length)
+    return SAFE_READ_ERROR;
+
   for (counter = 0; counter < status; counter += rlen, buffer += rlen)
     {
       rlen = safe_read (READ_SIDE (handle), buffer, status - counter);
-- 
1.7.2.5

